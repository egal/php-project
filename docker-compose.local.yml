version: "3.7"
services:
  postgres:
    ports:
      - published: 5433
        target: 5432
  backend:
    build:
      args:
        DEBUG: 'true'
    user: ${UID}:${GID}
    volumes:
      - ./server/backend:/app:rw
    ports:
      - published: 81
        target: 8080
    command: sh -c "/wait && php -S 0.0.0.0:8080 -t public"
    command: sh -c "/wait && php artisan octane:start --host=0.0.0.0 --port=8080 --watch"
    command: sh -c "/wait && php artisan octane:start --host=0.0.0.0 --port=8080"
    environment:
      APP_ENV: local
      APP_DEBUG: 'true'
      LOG_CHANNEL: syslog
