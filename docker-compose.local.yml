volumes:
  database: {}

version: "3.7"
services:
  postgres:
    ports:
      - published: 5433
        target: 5432
    volumes:
      - database:/var/lib/postgresql/data
  main-service:
    build:
      args:
        DEBUG: 'true'
    user: ${UID}:${GID}
    volumes:
      - .:/app:rw
    ports:
      - published: 80
        target: 8080
    command: sh -c "/wait && php -S 0.0.0.0:8080 -t public"
    command: sh -c "/wait && php artisan octane:start --host=0.0.0.0 --port=8080"
    command: php artisan octane:start --host=0.0.0.0 --port=8080
    command: sh -c "/wait && php artisan octane:start --host=0.0.0.0 --port=8080 --watch"
    environment:
      APP_ENV: local
      APP_DEBUG: 'false'
      LOG_CHANNEL: stack
